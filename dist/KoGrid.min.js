/*! KoGrid v2.1.5 | MIT License */
!function(e){"use strict";e.kg||(e.kg={}),e.kg.numberOfGrids=0,e.kg.eventStorage={};var t="__kg_selected__",o=8,n=6,i="asc",r="desc",a="_kg_field_",l="_kg_depth_",s="_kg_hidden_",c="_kg_column_",d=/<.+>/;e.kg.moveSelectionHandler=function(t,n){if(e.kg.utils.isNullOrUndefined(t)||e.kg.utils.isNullOrUndefined(t.config.selectedItems))return!0;var i=n.which||n.keyCode,r=38===i?-1:40===i?1:null;if(!r)return!0;var a=t.renderedRows(),l=a.indexOf(t.selectionService.lastClickedRow)+r;return 0>l||l>=a.length?!0:(t.selectionService.ChangeSelection(a[l],n),l>a.length-o?t.$viewport.scrollTop(t.$viewport.scrollTop()+t.config.rowHeight*o):o>l&&t.$viewport.scrollTop(t.$viewport.scrollTop()-t.config.rowHeight*o),!1)},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,o=Number(arguments[1])||0;for(o=0>o?Math.ceil(o):Math.floor(o),0>o&&(o+=t);t>o;o++)if(o in this&&this[o]===e)return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e){var t=Object(this),o=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=[],i=arguments[1],r=0;o>r;r++)if(r in t){var a=t[r];e.call(i,a,r,t)&&n.push(a)}return n}),e.kg.utils={visualLength:function(e){var t=document.getElementById("testDataLength");return t||(t=document.createElement("SPAN"),t.id="testDataLength",t.style.visibility="hidden",document.body.appendChild(t)),$(t).css("font",$(e).css("font")),t.innerHTML=$(e).text(),t.offsetWidth},forIn:function(e,t){for(var o in e)e.hasOwnProperty(o)&&t(e[o],o)},evalProperty:function(e,t){var o=ko.utils.unwrapObservable(e),n=t.split("."),i=0,r=ko.utils.unwrapObservable(o[n[i]]),a=n.length;for(i++;r&&a>i;)r=ko.utils.unwrapObservable(r[n[i]]),i++;return r},endsWith:function(e,t){return e&&t&&"string"==typeof e?-1!==e.indexOf(t,e.length-t.length):!1},isNullOrUndefined:function(e){return void 0===e||null===e?!0:!1},getElementsByClassName:function(e){for(var t=[],o=new RegExp("\\b"+e+"\\b"),n=document.getElementsByTagName("*"),i=0;i<n.length;i++){var r=n[i].className;o.test(r)&&t.push(n[i])}return t},getTemplatePromise:function(e){return $.ajax(e)},newId:function(){var e=(new Date).getTime();return function(){return e+=1}}(),ieVersion:function(){for(var e=3,t=document.createElement("div"),o=t.getElementsByTagName("i");t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",o[0];);return e>4?e:void 0}()},$.extend(e.kg.utils,{isIe6:function(){return 6===e.kg.utils.ieVersion}(),isIe7:function(){return 7===e.kg.utils.ieVersion}(),isIe:function(){return void 0!==e.kg.utils.ieVersion}()}),e.kg.aggregateTemplate=function(){return'<div data-bind="click: toggleExpand, style: {\'left\': offsetLeft()}" class="kgAggregate"><span class="kgAggregateText" data-bind="html: $data.label">(<span data-bind="html: totalChildren"></span> Items)</span><div data-bind="attr: {\'class\' : aggClass }"></div></div>'},e.kg.defaultCellTemplate=function(){return"<div data-bind=\"attr: { 'class': 'kgCellText colt' + $index()}, html: $data.getProperty($parent)\"></div>"},e.kg.defaultGridTemplate=function(){return'<div data-bind="css: {\'ui-widget\': jqueryUITheme, \'kgNoSelect\' : disableTextSelection}"><div class="kgTopPanel" data-bind="css: {\'ui-widget-header\':jqueryUITheme, \'ui-corner-top\': jqueryUITheme}, style: $data.topPanelStyle"><div class="kgGroupPanel" data-bind="visible: $data.showGroupPanel, style: headerStyle"><div class="kgGroupPanelDescription" data-bind="visible: configGroups().length == 0">Drag a column header here and drop it to group by that column</div><ul data-bind="visible: configGroups().length > 0, foreach: configGroups" class="kgGroupList"><li class="kgGroupItem"><span class="kgGroupElement"><div class="kgGroupName"><span data-bind="text: displayName"></span> <span data-bind="click: function(data) { $root.removeGroup($index()) }" class="kgRemoveGroup">x</span></div><span data-bind="visible: $index() < ($root.configGroups().length - 1)" class="kgGroupArrow"></span></span></li></ul></div><div class="kgHeaderContainer" data-bind="style: headerStyle"><div class="kgHeaderScroller" data-bind="style: headerScrollerStyle, kgHeaderRow: $data"></div></div><div class="kgHeaderButton" data-bind="visible: ($data.showColumnMenu || $data.showFilter), click: toggleShowMenu"><div class="kgHeaderButtonArrow"></div></div><div data-bind="visible: showMenu" class="kgColMenu"><div data-bind="visible: showFilter"><input placeholder="Search Field:Value" type="text" data-bind="value: filterText, valueUpdate: \'afterkeydown\'"></div><div data-bind="visible: showColumnMenu"><span class="kgMenuText">Choose Columns:</span><ul class="kgColList" data-bind="foreach: nonAggColumns"><li class="kgColListItem"><label style="position: relative"><input type="checkbox" class="kgColListCheckbox" data-bind="checked: visible"> <span data-bind="text: displayName, click: toggleVisible"></span> <a title="Group By" data-bind="attr: {\'class\': groupedByClass }, visible: (field != \'\\u2714\'), click: $parent.groupBy"></a> <span class="kgGroupingNumber" data-bind="visible: groupIndex() > 0, text: groupIndex"></span></label></li></ul></div></div></div><div class="kgViewport" data-bind="css: {\'ui-widget-content\': jqueryUITheme}, style: viewportStyle"><div class="kgCanvas" data-bind="style: canvasStyle"><div data-bind="foreach: renderedRows" style="position: absolute"><div data-bind="style: { \'top\': offsetTop, \'height\': $parent.rowHeight + \'px\' }, click: toggleSelected, css: {\'selected\': selected, \'even\': isEven , \'odd\': isOdd, \'ui-state-default\': $parent.jqueryUITheme && isOdd, \'ui-state-active\':$parent.jqueryUITheme && isEven}, kgRow: $data" class="kgRow"></div></div></div></div><div class="kgFooterPanel" data-bind="css: {\'ui-widget-content\': jqueryUITheme, \'ui-corner-bottom\': jqueryUITheme}, style: footerStyle"><div class="kgTotalSelectContainer" data-bind="visible: footerVisible"><div class="kgFooterTotalItems" data-bind="css: {\'kgNoMultiSelect\': !multiSelect}"><span class="kgLabel">Total Items: <span data-bind="text: maxRowsDisplay"></span></span><span data-bind="visible: filterText().length > 0" class="kgLabel">(Showing: <span data-bind="text: totalFilteredItemsLength"></span>)</span></div><div class="kgFooterSelectedItems" data-bind="visible: multiSelect"><span class="kgLabel">Selected Items: <span data-bind="text: selectedItemCount"></span></span></div></div><div class="kgPagerContainer" style="float: right; margin-top: 10px" data-bind="visible: (footerVisible && enablePaging), css: {\'kgNoMultiSelect\': !multiSelect}"><div style="float:left; margin-right: 10px" class="kgRowCountPicker"><span style="float: left; margin-top: 3px" class="kgLabel">Page Size:</span><select style="float: left;height: 27px; width: 100px" data-bind="value: pagingOptions.pageSize, options: pagingOptions.pageSizes"></select></div><div style="float:left; margin-right: 10px; line-height:25px" class="kgPagerControl" style="float: left; min-width: 135px"><button class="kgPagerButton" data-bind="click: pageToFirst, disable: cantPageBackward()" title="First Page"><div class="kgPagerFirstTriangle"><div class="kgPagerFirstBar"></div></div></button> <button class="kgPagerButton" data-bind="click: pageBackward, disable: cantPageBackward()" title="Previous Page"><div class="kgPagerFirstTriangle kgPagerPrevTriangle"></div></button> <input class="kgPagerCurrent" type="number" style="width:50px; height: 24px; margin-top: 1px; padding: 0px 4px" data-bind="value: pagingOptions.currentPage, valueUpdate: \'afterkeydown\'"> <button class="kgPagerButton" data-bind="click: pageForward, disable: cantPageForward()" title="Next Page"><div class="kgPagerLastTriangle kgPagerNextTriangle"></div></button> <button class="kgPagerButton" data-bind="click: pageToLast, disable: cantPageForward()" title="Last Page"><div class="kgPagerLastTriangle"><div class="kgPagerLastBar"></div></div></button></div></div></div></div>'},e.kg.defaultHeaderCellTemplate=function(){return"<div data-bind=\"style: { cursor : sortable() ? 'pointer' : 'default' }, click: sort, css: {'kgSorted': !noSortVisible }, attr: {'class': 'kgHeaderSortColumn ' + headerClass()}\"><div data-bind=\"attr: { 'class': 'colt' + $index() + ' kgHeaderText' }, html: displayName\"></div><div class=\"kgSortButtonDown\" data-bind=\"visible: showSortButtonDown\"></div><div class=\"kgSortButtonUp\" data-bind=\"visible: showSortButtonUp\"></div><div data-bind=\"visible: resizable, click: gripClick, mouseEvents: { mouseDown: gripOnMouseDown }\" class=\"kgHeaderGrip\"></div></div>"},e.kg.defaultHeaderRowTemplate=function(){return"<div data-bind=\"foreach: visibleColumns\"><div data-bind=\"kgHeaderCell: $data, attr: { 'class': 'kgHeaderCell col' + $index() }\"></div></div>"},e.kg.defaultRowTemplate=function(){return"<div data-bind=\"style: { cursor : canSelectRows ? 'pointer' : 'default' }, foreach: $grid.visibleColumns, css: { 'ui-widget-content': $grid.jqueryUITheme }\"><div data-bind=\"attr: { 'class': cellClass() + ' kgCell col' + $index() }, kgCell: $data\"></div></div>"},ko.bindingHandlers.kgCell=function(){return{init:function(e,t,o,n,i){i.$userViewModel=i.$parent.$userViewModel;var r=function(t){var o=$(t);ko.applyBindings(i,o[0]),$(e).html(o)};return n.cellTemplate.then?n.cellTemplate.then(function(e){r(e)}):r(n.cellTemplate),{controlsDescendantBindings:!0}}}}(),ko.bindingHandlers.kgHeaderCell=function(){return{init:function(e,t,o,n,i){var r=i.extend({$grid:i.$parent,$userViewModel:i.$parent.$userViewModel}),a=function(t){var o=$(t);ko.applyBindings(r,o[0]),$(e).html(o)};return n.headerCellTemplate.then?n.headerCellTemplate.then(function(e){a(e)}):a(n.headerCellTemplate),{controlsDescendantBindings:!0}}}}(),ko.bindingHandlers.kgHeaderRow=function(){return{init:function(e,t,o,n,i){i.$userViewModel=i.$data.$userViewModel;var r=function(t){var o=$(t);ko.applyBindings(i,o[0]),$(e).html(o)};return n.headerRowTemplate.then?n.headerRowTemplate.then(function(e){r(e)}):r(n.headerRowTemplate),{controlsDescendantBindings:!0}}}}(),ko.bindingHandlers.mouseEvents=function(){return{init:function(e,t){var o=t();o.mouseDown&&$(e).mousedown(o.mouseDown)}}}(),ko.bindingHandlers.kgRow=function(){return{init:function(t,o,n,i,r){var a,l=o(),s=l.$grid=r.$parent;a=l.isAggRow?e.kg.aggregateTemplate():s.rowTemplate;var c=function(e){var o=$(e);l.$userViewModel=r.$parent.$userViewModel,ko.applyBindings(l,o[0]),$(t).html(o)};return a.then?a.then(function(e){c(e)}):c(a),{controlsDescendantBindings:!0}}}}(),ko.bindingHandlers.koGrid=function(){return{init:function(t,o,n,i,r){var a=o(),l=$(t);a.gridDim=new e.kg.Dimension({outerHeight:ko.observable(l.height()),outerWidth:ko.observable(l.width())});var s=new e.kg.Grid(a),c=$(e.kg.defaultGridTemplate());return a.data.subscribe(function(){s.$$selectionPhase||(s.searchProvider.evalFilter(),s.refreshDomSizes())}),ko.isObservable(a.columnDefs)&&a.columnDefs.subscribe(function(e){s.columns([]),s.config.columnDefs=e,s.buildColumns(),s.configureColumnWidths()}),l.addClass("koGrid").addClass(s.gridId.toString()),l.append(c),s.$userViewModel=r.$data,ko.applyBindings(s,c[0]),e.kg.domUtilityService.AssignGridContainers(l,s),s.configureColumnWidths(),s.refreshDomSizes(),s.eventProvider=new e.kg.EventProvider(s),$.each(s.config.plugins,function(e,t){"function"==typeof t.onGridInit&&t.onGridInit(s)}),e.kg.domUtilityService.BuildStyles(s),{controlsDescendantBindings:!0}}}}(),e.kg.Aggregate=function(e,t){var o=this;o.index=0,o.offsetTop=ko.observable(0),o.entity=e,o.label=ko.observable(e.gLabel),o.field=e.gField,o.depth=e.gDepth,o.parent=e.parent,o.children=e.children,o.aggChildren=e.aggChildren,o.aggIndex=e.aggIndex,o.collapsed=ko.observable(!0),o.isAggRow=!0,o.offsetLeft=ko.observable((25*e.gDepth).toString()+"px"),o.aggLabelFilter=e.aggLabelFilter,o.toggleExpand=function(){var e=o.collapsed();o.collapsed(!e),o.notifyChildren()},o.setExpand=function(e){o.collapsed(e),o.notifyChildren()},o.notifyChildren=function(){$.each(o.aggChildren,function(e,t){if(t.entity[s]=o.collapsed(),o.collapsed()){var n=o.collapsed();t.setExpand(n)}}),$.each(o.children,function(e,t){t[s]=o.collapsed()}),t.rowCache=[];var e=!1;$.each(t.aggCache,function(t,n){if(e){var i=30*o.children.length,r=o.collapsed();n.offsetTop(r?n.offsetTop()-i:n.offsetTop()+i)}else t==o.aggIndex&&(e=!0)}),t.renderedChange()},o.aggClass=ko.computed(function(){return o.collapsed()?"kgAggArrowCollapsed":"kgAggArrowExpanded"}),o.totalChildren=ko.computed(function(){if(o.aggChildren.length>0){var e=0,t=function(o){o.aggChildren.length>0?$.each(o.aggChildren,function(e,o){t(o)}):e+=o.children.length};return t(o),e}return o.children.length}),o.selected=ko.observable(!1),o.isEven=ko.observable(!1),o.isOdd=ko.observable(!1),o.toggleSelected=function(){return!0}},e.kg.Column=function(t,o){var n=this,a=t.colDef,l=500,s=0,c=null;n.eventTaget=void 0,n.width=a.width,n.groupIndex=ko.observable(0),n.isGroupedBy=ko.observable(!1),n.groupedByClass=ko.computed(function(){return n.isGroupedBy()?"kgGroupedByIcon":"kgGroupIcon"}),n.sortable=ko.observable(!1),n.resizable=ko.observable(!1),n.minWidth=a.minWidth?a.minWidth:50,n.maxWidth=a.maxWidth?a.maxWidth:9e3,n.headerRowHeight=t.headerRowHeight,n.displayName=ko.observable(a.displayName||a.field),n.index=t.index,n.isAggCol=t.isAggCol,n.cellClass=ko.observable(a.cellClass||""),n.cellFilter=a.cellFilter||a.cellFormatter,n.field=a.field,n.aggLabelFilter=a.cellFilter||a.cellFormatter||a.aggLabelFilter||a.aggLabelFormatter,n._visible=ko.observable(e.kg.utils.isNullOrUndefined(a.visible)||a.visible),n.visible=ko.computed({read:function(){return n._visible()},write:function(e){n.toggleVisible(e)}}),t.enableSort&&n.sortable(e.kg.utils.isNullOrUndefined(a.sortable)||a.sortable),t.enableResize&&n.resizable(e.kg.utils.isNullOrUndefined(a.resizable)||a.resizable),n.sortDirection=ko.observable(void 0),n.sortingAlgorithm=a.sortFn,n.headerClass=ko.observable(a.headerClass),n.headerCellTemplate=a.headerCellTemplate||e.kg.defaultHeaderCellTemplate(),n.cellTemplate=a.cellTemplate||e.kg.defaultCellTemplate(),a.cellTemplate&&!d.test(a.cellTemplate)&&(n.cellTemplate=e.kg.utils.getTemplatePromise(a.cellTemplate)),a.headerCellTemplate&&!d.test(a.headerCellTemplate)&&(n.headerCellTemplate=e.kg.utils.getTemplatePromise(a.headerCellTemplate)),n.getProperty=function(e){var t;return t=n.cellFilter?n.cellFilter(e.getProperty(n.field)):e.getProperty(n.field)},n.toggleVisible=function(t){var i;i=e.kg.utils.isNullOrUndefined(t)||"object"==typeof t?!n._visible():t,n._visible(i),e.kg.domUtilityService.BuildStyles(o)},n.showSortButtonUp=ko.computed(function(){return n.sortable?n.sortDirection()===r:n.sortable}),n.showSortButtonDown=ko.computed(function(){return n.sortable?n.sortDirection()===i:n.sortable}),n.noSortVisible=ko.computed(function(){return!n.sortDirection()}),n.sort=function(){if(!n.sortable())return!0;var e=n.sortDirection()===i?r:i;return n.sortDirection(e),t.sortCallback(n,e),!1},n.gripClick=function(e,o){o.stopPropagation(),s++,1===s?c=setTimeout(function(){s=0},l):(clearTimeout(c),t.resizeOnDataCallback(n),s=0)},n.gripOnMouseDown=function(t){return t.stopPropagation(),t.ctrlKey?(n.toggleVisible(),e.kg.domUtilityService.BuildStyles(o),o.config.columnsChanged(o.columns.peek()),!0):(n.eventTaget=t.target.parentElement,n.eventTaget.style.cursor="col-resize",n.startMousePosition=t.clientX,n.origWidth=n.width,$(document).mousemove(n.onMouseMove),$(document).mouseup(n.gripOnMouseUp),!1)},n.onMouseMove=function(t){t.stopPropagation();var i=t.clientX-n.startMousePosition,r=i+n.origWidth;return n.width=r<n.minWidth?n.minWidth:r>n.maxWidth?n.maxWidth:r,e.kg.domUtilityService.BuildStyles(o),!1},n.gripOnMouseUp=function(e){return e.stopPropagation(),$(document).off("mousemove"),$(document).off("mouseup"),n.eventTaget.style.cursor=n.sortable()?"pointer":"default",n.eventTaget=void 0,o.config.columnsChanged(o.columns.peek()),!1}},e.kg.Dimension=function(e){this.outerHeight=null,this.outerWidth=null,$.extend(this,e)};var g=function(){var t=$("<div></div>");t.appendTo("body"),t.height(100).width(100).css("position","absolute").css("overflow","scroll"),t.append('<div style="height: 400px; width: 400px;"></div>'),e.kg.domUtilityService.ScrollH=t.height()-t[0].clientHeight,e.kg.domUtilityService.ScrollW=t.width()-t[0].clientWidth,t.empty(),t.attr("style",""),t.append('<span style="font-family: Verdana, Helvetica, Sans-Serif; font-size: 14px;"><strong>M</strong></span>'),e.kg.domUtilityService.LetterW=t.children().first().width(),t.remove()};e.kg.domUtilityService={AssignGridContainers:function(t,o){o.$root=$(t),o.$topPanel=o.$root.find(".kgTopPanel"),o.$groupPanel=o.$root.find(".kgGroupPanel"),o.$headerContainer=o.$topPanel.find(".kgHeaderContainer"),o.$headerScroller=o.$topPanel.find(".kgHeaderScroller"),o.$headers=o.$headerScroller.children(),o.$viewport=o.$root.find(".kgViewport"),o.$canvas=o.$viewport.find(".kgCanvas"),o.$footerPanel=o.$root.find(".ngFooterPanel"),e.kg.domUtilityService.UpdateGridLayout(o)},UpdateGridLayout:function(e){var t=e.$viewport.scrollTop();e.elementDims.rootMaxW=e.$root.width(),e.elementDims.rootMaxH=e.$root.height(),e.refreshDomSizes(),e.adjustScrollTop(t,!0)},BuildStyles:function(t){var o,n=t.config.rowHeight,i=t.$styleSheet,r=t.gridId,a=t.visibleColumns(),l=0;i||(i=$("#"+r),i[0]||(i=$("<style id='"+r+"' type='text/css' rel='stylesheet' />"),i.appendTo("body"))),i.empty();var s=t.totalRowWidth();o="."+r+" .kgCanvas { width: "+s+"px; }."+r+" .kgRow { width: "+s+"px; }."+r+" .kgCell { height: "+n+"px; }."+r+" .kgCanvas { width: "+s+"px; }."+r+" .kgHeaderCell { top: 0; bottom: 0; }."+r+" .kgHeaderScroller { width: "+(s+e.kg.domUtilityService.scrollH+2)+"px}",$.each(a,function(e,t){o+="."+r+" .col"+e+" { width: "+t.width+"px; left: "+l+"px; right: "+(s-l-t.width)+"px; height: "+n+"px }."+r+" .colt"+e+" { width: "+t.width+"px; }",l+=t.width}),e.kg.utils.isIe?i[0].styleSheet.cssText=o:i.append(document.createTextNode(o)),t.$styleSheet=i},ScrollH:17,ScrollW:17,LetterW:10},g(),e.kg.EventProvider=function(t){var o=this;o.colToMove=void 0,o.groupToMove=void 0,o.assignEvents=function(){t.config.jqueryUIDraggable?(t.$groupPanel.droppable({addClasses:!1,drop:function(e){o.onGroupDrop(e)}}),$(document).ready(o.setDraggables)):(t.$groupPanel.on("mousedown",o.onGroupMouseDown).on("dragover",o.dragOver).on("drop",o.onGroupDrop),t.$headerScroller.on("mousedown",o.onHeaderMouseDown).on("dragover",o.dragOver).on("drop",o.onHeaderDrop),t.config.enableRowReordering&&t.$viewport.on("mousedown",o.onRowMouseDown).on("dragover",o.dragOver).on("drop",o.onRowDrop),o.setDraggables()),t.columns.subscribe(o.setDraggables)},o.dragOver=function(e){e.preventDefault()},o.setDraggables=function(){t.config.jqueryUIDraggable?t.$root.find(".kgHeaderSortColumn").draggable({helper:"clone",appendTo:"body",stack:"div",addClasses:!1,start:function(e){o.onHeaderMouseDown(e)}}).droppable({drop:function(e){o.onHeaderDrop(e)}}):(t.$root.find(".kgHeaderSortColumn").attr("draggable","true"),-1!=navigator.userAgent.indexOf("MSIE")&&t.$root.find(".kgHeaderSortColumn").bind("selectstart",function(){return this.dragDrop(),!1}))},o.onGroupMouseDown=function(e){var n=$(e.target);if("kgRemoveGroup"!=n[0].className){var i=ko.dataFor(n[0]);i&&(t.config.jqueryUIDraggable||n.attr("draggable","true"),o.groupToMove={header:n,groupName:i,index:i.groupIndex()-1})}else o.groupToMove=void 0},o.onGroupDrop=function(e){var n,i;o.groupToMove?(n=$(e.target).closest(".kgGroupElement"),"kgGroupPanel"==n.context.className?(t.configGroups.splice(o.groupToMove.index,1),t.configGroups.push(o.groupToMove.groupName)):(i=ko.dataFor(n[0]),i&&o.groupToMove.index!=i.groupIndex()&&(t.configGroups.splice(o.groupToMove.index,1),t.configGroups.splice(i.groupIndex(),0,o.groupToMove.groupName))),o.groupToMove=void 0,t.fixGroupIndexes()):(-1==t.configGroups.indexOf(o.colToMove.col)&&(n=$(e.target).closest(".kgGroupElement"),"kgGroupPanel"==n.context.className||"kgGroupPanelDescription"==n.context.className?t.groupBy(o.colToMove.col):(i=ko.dataFor(n[0]),i&&t.removeGroup(i.groupIndex()))),o.colToMove=void 0)},o.onHeaderMouseDown=function(e){var t=$(e.target).closest(".kgHeaderSortColumn");if(!t[0])return!0;var n=ko.dataFor(t[0]);return n&&(o.colToMove={header:t,col:n}),!0},o.onHeaderDrop=function(n){if(!o.colToMove)return!0;var i=$(n.target).closest(".kgHeaderSortColumn");if(!i[0])return!0;var r=ko.dataFor(i[0]);if(r){if(o.colToMove.col==r)return!0;var a=t.columns.peek();a.splice(o.colToMove.col.index,1),a.splice(r.index,0,o.colToMove.col),t.fixColumnIndexes(),t.columns(a),e.kg.domUtilityService.BuildStyles(t),o.colToMove=void 0}return!0},o.onRowMouseDown=function(t){var o=$(t.target).closest(".kgRow");if(o[0]){var n=ko.dataFor(o[0]);n&&(o.attr("draggable","true"),e.kg.eventStorage.rowToMove={targetRow:o,scope:n})}},o.onRowDrop=function(o){var n=$(o.target).closest(".kgRow"),i=ko.dataFor(n[0]);if(i){var r=e.kg.eventStorage.rowToMove;if(r.scope==i)return;var a=t.sortedData(),l=a.indexOf(r.scope.entity),s=a.indexOf(i.entity);t.sortedData.splice(l,1),t.sortedData.splice(s,0,r.scope.entity),t.searchProvider.evalFilter(),e.kg.eventStorage.rowToMove=void 0}},o.assignGridEventHandlers=function(){t.$viewport.scroll(function(e){var o=e.target.scrollLeft,n=e.target.scrollTop;t.adjustScrollLeft(o),t.adjustScrollTop(n)}),t.$viewport.off("keydown"),t.$viewport.on("keydown",function(o){return e.kg.moveSelectionHandler(t,o)}),-1===t.config.tabIndex?(t.$viewport.attr("tabIndex",e.kg.numberOfGrids),e.kg.numberOfGrids++):t.$viewport.attr("tabIndex",t.config.tabIndex),$(e).resize(function(){e.kg.domUtilityService.UpdateGridLayout(t),t.config.maintainColumnRatios&&t.configureColumnWidths()})},o.assignGridEventHandlers(),o.assignEvents()},e.kg.Grid=function(i){var r={rowHeight:30,columnWidth:100,headerRowHeight:30,footerRowHeight:55,footerVisible:!0,displayFooter:void 0,canSelectRows:!0,selectAllState:ko.observable(!1),data:ko.observableArray([]),columnDefs:void 0,selectedItems:ko.observableArray([]),displaySelectionCheckbox:!0,selectWithCheckboxOnly:!1,useExternalSorting:!1,sortInfo:ko.observable(void 0),multiSelect:!0,tabIndex:-1,enableColumnResize:!0,enableSorting:!0,maintainColumnRatios:void 0,beforeSelectionChange:function(){return!0},afterSelectionChange:function(){},columnsChanged:function(){},rowTemplate:void 0,headerRowTemplate:void 0,jqueryUITheme:!1,jqueryUIDraggable:!1,plugins:[],keepLastSelected:!0,groups:[],showGroupPanel:!1,enableRowReordering:!1,showColumnMenu:!0,showFilter:!0,disableTextSelection:!0,filterOptions:{filterText:ko.observable(""),useExternalFilter:!1},enablePaging:!1,pagingOptions:{pageSizes:ko.observableArray([250,500,1e3]),pageSize:ko.observable(250),totalServerItems:ko.observable(0),currentPage:ko.observable(1)}},a=this;a.maxCanvasHt=ko.observable(0),a.config=$.extend(r,i),a.config.columnDefs=ko.utils.unwrapObservable(i.columnDefs),a.gridId="ng"+e.kg.utils.newId(),a.$root=null,a.$groupPanel=null,a.$topPanel=null,a.$headerContainer=null,a.$headerScroller=null,a.$headers=null,a.$viewport=null,a.$canvas=null,a.rootDim=a.config.gridDim,a.sortInfo=ko.isObservable(a.config.sortInfo)?a.config.sortInfo:ko.observable(a.config.sortInfo),a.sortedData=a.config.data,a.lateBindColumns=!1,a.filteredData=ko.observableArray([]),a.lastSortedColumn=void 0,a.showFilter=a.config.showFilter,a.filterText=a.config.filterOptions.filterText,a.disableTextSelection=ko.observable(a.config.disableTextSelection),a.calcMaxCanvasHeight=function(){return a.configGroups().length>0?a.rowFactory.parsedData.filter(function(e){return e[s]===!1}).length*a.config.rowHeight:a.filteredData().length*a.config.rowHeight},a.elementDims={scrollW:0,scrollH:0,rowIndexCellW:25,rowSelectedCellW:25,rootMaxW:0,rootMaxH:0},a.setRenderedRows=function(e){a.renderedRows(e),a.refreshDomSizes()},a.minRowsToRender=function(){var e=a.viewportDimHeight()||1;return Math.floor(e/a.config.rowHeight)},a.refreshDomSizes=function(){a.rootDim.outerWidth(a.elementDims.rootMaxW),a.rootDim.outerHeight(a.elementDims.rootMaxH),a.maxCanvasHt(a.calcMaxCanvasHeight())},a.buildColumnDefsFromData=function(){var o=a.sortedData();if(a.config.columnDefs||(a.config.columnDefs=[]),!o||!o[0])return void(a.lateBoundColumns=!0);var n;n=o[0],e.kg.utils.forIn(n,function(e,o){o!=t&&a.config.columnDefs.push({field:o})})},a.buildColumns=function(){var t=a.config.columnDefs,o=[];t||(a.buildColumnDefsFromData(),t=a.config.columnDefs),a.config.displaySelectionCheckbox&&a.config.canSelectRows&&t.splice(0,0,{field:"✔",width:a.elementDims.rowSelectedCellW,sortable:!1,resizable:!1,headerCellTemplate:'<input class="kgSelectionHeader" type="checkbox" data-bind="visible: $grid.multiSelect, checked: $grid.allSelected"/>',cellTemplate:'<div class="kgSelectionCell"><input class="kgSelectionCheckbox" type="checkbox" data-bind="checked: $parent.selected" /></div>'}),t.length>0&&($.each(t,function(t,n){var i=new e.kg.Column({colDef:n,index:t,headerRowHeight:a.config.headerRowHeight,sortCallback:a.sortData,resizeOnDataCallback:a.resizeOnData,enableResize:a.config.enableColumnResize,enableSort:a.config.enableSorting},a);o.push(i);var r=a.config.groups.indexOf(n.field);-1!=r&&a.configGroups.splice(r,0,i)}),a.columns(o))},a.configureColumnWidths=function(){var t=a.config.columnDefs,o=t.length,n=[],i=[],r=0,l=0,s=a.columns();if($.each(t,function(t,o){var c=!1,d=void 0;if(e.kg.utils.isNullOrUndefined(o.width)?o.width="*":(c=isNaN(o.width)?e.kg.utils.endsWith(o.width,"%"):!1,d=c?o.width:parseInt(o.width,10)),isNaN(d)){if(d=o.width,"auto"==d){s[t].width=s[t].minWidth;var g=s[t];return void $(document).ready(function(){a.resizeOnData(g,!0)})}if(-1!=d.indexOf("*"))return r+=d.length,o.index=t,void n.push(o);if(c)return o.index=t,void i.push(o);throw'unable to parse column width, use percentage ("10%","20%", etc...) or "*" to use remaining width of grid'}l+=s[t].width=parseInt(o.width,10)}),n.length>0){a.config.maintainColumnRatios===!1?$.noop():a.config.maintainColumnRatios=!0;var c=a.rootDim.outerWidth()-l,d=Math.floor(c/r);$.each(n,function(t,n){var i=n.width.length;if(s[n.index].width=d*i,n.index+1==o){var r=2;a.maxCanvasHt()>a.viewportDimHeight()&&(r+=e.kg.domUtilityService.ScrollW),s[n.index].width-=r}l+=s[n.index].width})}i.length>0&&$.each(i,function(e,t){var o=t.width;s[t.index].width=Math.floor(a.rootDim.outerWidth()*(parseInt(o.slice(0,-1),10)/100))}),a.columns(s),e.kg.domUtilityService.BuildStyles(a)},a.init=function(){a.selectionService=new e.kg.SelectionService(a),a.rowFactory=new e.kg.RowFactory(a),a.selectionService.Initialize(a.rowFactory),a.searchProvider=new e.kg.SearchProvider(a),a.styleProvider=new e.kg.StyleProvider(a),a.buildColumns(),e.kg.sortService.columns=a.columns,a.configGroups.subscribe(function(e){if(e){var t=[];$.each(e,function(e,o){o&&t.push(o.field||o)}),a.config.groups=t,a.rowFactory.filteredDataChanged()}}),a.filteredData.subscribe(function(){a.$$selectionPhase||(a.maxCanvasHt(a.calcMaxCanvasHeight()),a.isSorting||a.configureColumnWidths())}),a.maxCanvasHt(a.calcMaxCanvasHeight()),a.searchProvider.evalFilter(),a.refreshDomSizes()},a.prevScrollTop=0,a.prevScrollIndex=0,a.adjustScrollTop=function(t,i){if(a.prevScrollTop!==t||i){var r=Math.floor(t/a.config.rowHeight);a.prevScrollTop<t&&r<a.prevScrollIndex+n||a.prevScrollTop>t&&r>a.prevScrollIndex-n||(a.prevScrollTop=t,a.rowFactory.UpdateViewableRange(new e.kg.Range(Math.max(0,r-o),r+a.minRowsToRender()+o)),a.prevScrollIndex=r)}},a.adjustScrollLeft=function(e){a.$headerContainer&&a.$headerContainer.scrollLeft(e)},a.resizeOnData=function(t){var o=t.minWidth,n=e.kg.utils.getElementsByClassName("col"+t.index);$.each(n,function(t,n){var i;if(0===t){var r=$(n).find(".kgHeaderText");i=e.kg.utils.visualLength(r)+10}else{var a=$(n).find(".kgCellText");i=e.kg.utils.visualLength(a)+10}i>o&&(o=i)}),t.width=o=Math.min(t.maxWidth,o+7),e.kg.domUtilityService.BuildStyles(a)},a.sortData=function(t,o){a.isSorting=!0,a.sortInfo({column:t,direction:o}),a.clearSortingData(t),a.config.useExternalSorting?a.config.sortInfo(a.sortInfo.peek()):e.kg.sortService.Sort(a.sortInfo.peek(),a.sortedData),a.lastSortedColumn=t,a.isSorting=!1},a.clearSortingData=function(e){e?a.lastSortedColumn&&e!=a.lastSortedColumn&&a.lastSortedColumn.sortDirection(""):$.each(a.columns(),function(e,t){t.sortDirection("")})},a.fixColumnIndexes=function(){a.$$indexPhase=!0;var e=a.columns.peek();$.each(e,function(e,t){t.index=e}),a.$$indexPhase=!1},a.elementsNeedMeasuring=!0,a.columns=ko.observableArray([]),a.columns.subscribe(function(e){a.config.columnsChanged(e)}),a.renderedRows=ko.observableArray([]),a.headerRow=null,a.rowHeight=a.config.rowHeight,a.jqueryUITheme=ko.observable(a.config.jqueryUITheme),a.footer=null,a.selectedItems=a.config.selectedItems,a.multiSelect=a.config.multiSelect,a.footerVisible=e.kg.utils.isNullOrUndefined(a.config.displayFooter)?a.config.footerVisible:a.config.displayFooter,a.config.footerRowHeight=a.footerVisible?a.config.footerRowHeight:0,a.showColumnMenu=a.config.showColumnMenu,a.showMenu=ko.observable(!1),a.configGroups=ko.observableArray([]),a.enablePaging=a.config.enablePaging,a.pagingOptions=a.config.pagingOptions,a.rowTemplate=a.config.rowTemplate||e.kg.defaultRowTemplate(),a.headerRowTemplate=a.config.headerRowTemplate||e.kg.defaultHeaderRowTemplate(),a.config.rowTemplate&&!d.test(a.config.rowTemplate)&&(a.rowTemplate=e.kg.utils.getTemplatePromise(a.config.rowTemplate)),a.config.headerRowTemplate&&!d.test(a.config.headerRowTemplate)&&(a.headerRowTemplate=e.kg.utils.getTemplatePromise(a.config.headerRowTemplate)),a.visibleColumns=ko.computed(function(){var e=a.columns();return e.filter(function(e){var t=e.visible();return t})}),a.nonAggColumns=ko.computed(function(){return a.columns().filter(function(e){return!e.isAggCol})}),a.toggleShowMenu=function(){a.showMenu(!a.showMenu())},a.allSelected=a.config.selectAllState,a.allSelected.subscribe(function(e){a.config.beforeSelectionChange(a.sortedData.peek(),this)&&(a.selectionService.toggleSelectAll(e),a.config.afterSelectionChange(a.selectedItems.peek(),this))}),a.totalFilteredItemsLength=ko.computed(function(){return a.filteredData().length}),a.showGroupPanel=ko.computed(function(){return a.config.showGroupPanel}),a.topPanelHeight=ko.observable(a.config.showGroupPanel===!0?2*a.config.headerRowHeight:a.config.headerRowHeight),a.viewportDimHeight=ko.computed(function(){return Math.max(0,a.rootDim.outerHeight()-a.topPanelHeight()-a.config.footerRowHeight-2)}),a.groupBy=function(t){if(!(a.sortedData().length<1)){var o=a.configGroups().indexOf(t);-1==o?(t.isGroupedBy(!0),a.configGroups.push(t),t.groupIndex(a.configGroups().length)):a.removeGroup(o),e.kg.domUtilityService.BuildStyles(a)}},a.removeGroup=function(t){var o=a.columns().filter(function(e){return e.groupIndex()==t+1})[0];o.isGroupedBy(!1),o.groupIndex(0),a.columns.splice(t,1),a.configGroups.splice(t,1),a.fixGroupIndexes(),0===a.configGroups().length&&a.fixColumnIndexes(),e.kg.domUtilityService.BuildStyles(a)},a.fixGroupIndexes=function(){$.each(a.configGroups(),function(e,t){t.groupIndex(e+1)})},a.totalRowWidth=function(){var e=0,t=a.visibleColumns();return $.each(t,function(t,o){e+=o.width}),e},a.headerScrollerDim=function(){var t=a.viewportDimHeight(),o=a.maxCanvasHt(),n=o>t,i=new e.kg.Dimension;return i.autoFitHeight=!0,i.outerWidth=a.totalRowWidth(),n?i.outerWidth+=a.elementDims.scrollW:o-t<=a.elementDims.scrollH&&(i.outerWidth+=a.elementDims.scrollW),i},a.jqueryUITheme=a.config.jqueryUITheme,a.maxRows=ko.observable(Math.max(a.config.pagingOptions.totalServerItems()||a.sortedData().length,1)),a.maxRowsDisplay=ko.computed(function(){return a.maxRows()}),a.multiSelect=ko.observable(a.config.canSelectRows&&a.config.multiSelect),a.selectedItemCount=ko.computed(function(){return a.selectedItems().length}),a.maxPages=ko.computed(function(){return a.maxRows(Math.max(a.config.pagingOptions.totalServerItems()||a.sortedData().length,1)),Math.ceil(a.maxRows()/a.pagingOptions.pageSize())
}),a.pageForward=function(){var e=a.config.pagingOptions.currentPage();a.config.pagingOptions.currentPage(Math.min(e+1,a.maxPages()))},a.pageBackward=function(){var e=a.config.pagingOptions.currentPage();a.config.pagingOptions.currentPage(Math.max(e-1,1))},a.pageToFirst=function(){a.config.pagingOptions.currentPage(1)},a.pageToLast=function(){var e=a.maxPages();a.config.pagingOptions.currentPage(e)},a.cantPageForward=ko.computed(function(){var e=a.config.pagingOptions.currentPage(),t=a.maxPages();return!(t>e)}),a.cantPageBackward=ko.computed(function(){var e=a.config.pagingOptions.currentPage();return!(e>1)}),a.init()},kg.Range=function(e,t){this.topRow=e,this.bottomRow=t},e.kg.Row=function(o,n,i){var r=this;r.canSelectRows=n.canSelectRows,r.rowClasses=n.rowClasses,r.selectedItems=n.selectedItems,r.entity=o,r.selectionService=i,r.selected=ko.observable(!1),r.continueSelection=function(e){r.selectionService.ChangeSelection(r,e)},r.toggleSelected=function(e,t){if(!r.canSelectRows)return!0;var o=t.target||t;return"checkbox"==o.type&&r.selected(!r.selected()),n.selectWithCheckboxOnly&&"checkbox"!=o.type?!0:r.beforeSelectionChange(r,t)?(r.continueSelection(t),r.afterSelectionChange(r,t)):!1},void 0===r.entity[t]?r.entity[t]=!1:r.selectionService.setSelection(r,r.entity[t]),r.rowIndex=ko.observable(0),r.offsetTop=ko.observable("0px"),r.rowDisplayIndex=0,r.isEven=ko.computed(function(){return r.rowIndex()%2===0?!0:!1}),r.isOdd=ko.computed(function(){return r.rowIndex()%2!==0?!0:!1}),r.beforeSelectionChange=n.beforeSelectionChangeCallback,r.afterSelectionChange=n.afterSelectionChangeCallback,r.propertyCache={},r.getProperty=function(t){return r.propertyCache[t]||(r.propertyCache[t]=e.kg.utils.evalProperty(r.entity,t))}},e.kg.RowFactory=function(n){var i=this;i.rowCache=[],i.aggCache={},i.parentCache=[],i.dataChanged=!0,i.parsedData=[],i.rowConfig={},i.selectionService=n.selectionService,i.rowHeight=30,i.numberOfAggregates=0,i.groupedData=void 0,i.rowHeight=n.config.rowHeight,i.rowConfig={canSelectRows:n.config.canSelectRows,rowClasses:n.config.rowClasses,selectedItems:n.config.selectedItems,selectWithCheckboxOnly:n.config.selectWithCheckboxOnly,beforeSelectionChangeCallback:n.config.beforeSelectionChange,afterSelectionChangeCallback:n.config.afterSelectionChange},i.renderedRange=new e.kg.Range(0,n.minRowsToRender()+o),i.buildEntityRow=function(o,n){var r=i.rowCache[n];return r||(r=new e.kg.Row(o,i.rowConfig,i.selectionService),r.rowIndex(n+1),r.offsetTop((i.rowHeight*n).toString()+"px"),r.selected(o[t]),i.rowCache[n]=r),r},i.buildAggregateRow=function(t,o){var n=i.aggCache[t.aggIndex];return n||(n=new e.kg.Aggregate(t,i),i.aggCache[t.aggIndex]=n),n.index=o+1,n.offsetTop((i.rowHeight*o).toString()+"px"),n},i.UpdateViewableRange=function(e){i.renderedRange=e,i.renderedChange()},i.filteredDataChanged=function(){n.lateBoundColumns&&n.filteredData().length>1&&(n.config.columnDefs=void 0,n.buildColumns(),n.lateBoundColumns=!1),i.dataChanged=!0,i.rowCache=[],n.config.groups.length>0&&i.getGrouping(n.config.groups),i.UpdateViewableRange(i.renderedRange)},i.renderedChange=function(){if(!i.groupedData||n.config.groups.length<1)return i.renderedChangeNoGroups(),void n.refreshDomSizes();i.parentCache=[];var e=[],t=i.parsedData.filter(function(e){return e[s]===!1}).slice(i.renderedRange.topRow,i.renderedRange.bottomRow);$.each(t,function(t,o){var n;n=o.isAggRow?i.buildAggregateRow(o,i.renderedRange.topRow+t):i.buildEntityRow(o,i.renderedRange.topRow+t),e.push(n)}),n.setRenderedRows(e),n.refreshDomSizes()},i.renderedChangeNoGroups=function(){var e=[],t=n.filteredData.slice(i.renderedRange.topRow,i.renderedRange.bottomRow);$.each(t,function(t,o){var n=i.buildEntityRow(o,i.renderedRange.topRow+t);e.push(n)}),n.setRenderedRows(e)},i.parseGroupData=function(e){if(e.values)$.each(e.values,function(e,t){i.parentCache[i.parentCache.length-1].children.push(t),i.parsedData.push(t)});else for(var t in e)if(t!=a&&t!=l&&t!=c&&e.hasOwnProperty(t)){var o=i.buildAggregateRow({gField:e[a],gLabel:t,gDepth:e[l],isAggRow:!0,_kg_hidden_:!1,children:[],aggChildren:[],aggIndex:i.numberOfAggregates,aggLabelFilter:e[c].aggLabelFilter},0);i.numberOfAggregates++,o.parent=i.parentCache[o.depth-1],o.parent&&(o.parent.collapsed(!1),o.parent.aggChildren.push(o)),i.parsedData.push(o.entity),i.parentCache[o.depth]=o,i.parseGroupData(e[t])}},i.getGrouping=function(t){i.aggCache=[],i.rowCache=[],i.numberOfAggregates=0,i.groupedData={};var o=n.filteredData(),r=t.length,d=n.columns();$.each(o,function(o,g){g[s]=!0;var u=i.groupedData;$.each(t,function(t,o){!d[t].isAggCol&&r>=t&&(n.columns.splice(g.gDepth,0,new e.kg.Column({colDef:{field:"",width:25,sortable:!1,resizable:!1,headerCellTemplate:'<div class="kgAggHeader"></div>'},isAggCol:!0,index:g.gDepth,headerRowHeight:n.config.headerRowHeight})),e.kg.domUtilityService.BuildStyles(n));var i=d.filter(function(e){return e.field==o})[0],s=e.kg.utils.evalProperty(g,o);i.cellFilter&&(s=i.cellFilter(s)),s=s?s.toString():"null",u[s]||(u[s]={}),u[a]||(u[a]=o),u[l]||(u[l]=t),u[c]||(u[c]=i),u=u[s]}),u.values||(u.values=[]),u.values.push(g)}),n.fixColumnIndexes(),i.parsedData.length=0,i.parseGroupData(i.groupedData)},n.config.groups.length>0&&n.filteredData().length>0&&i.getGrouping(n.config.groups)},e.kg.SearchProvider=function(e){var t,o=this,n=[];o.extFilter=e.config.filterOptions.useExternalFilter,o.showFilter=e.config.showFilter,o.filterText=e.config.filterOptions.filterText,o.throttle=e.config.filterOptions.filterThrottle,o.fieldMap={},o.evalFilter=function(){e.filteredData(0===n.length?e.sortedData.peek().filter(function(e){return!e._destroy}):e.sortedData.peek().filter(function(e){if(e._destroy)return!1;for(var t=0,i=n.length;i>t;t++){var r=n[t];if(!r.column){for(var a in e)if(e.hasOwnProperty(a)){var l=ko.utils.unwrapObservable(e[a]);if(l&&r.regex.test(l.toString()))return!0}return!1}var s=ko.utils.unwrapObservable(e[r.column])||ko.utils.unwrapObservable(e[o.fieldMap[r.columnDisplay]]);if(!s||!r.regex.test(s.toString()))return!1}return!0})),e.rowFactory.filteredDataChanged()};var i=function(e,t){try{return new RegExp(e,t)}catch(o){return new RegExp(e.replace(/(\^|\$|\(|\)|\<|\>|\[|\]|\{|\}|\\|\||\.|\*|\+|\?)/g,"\\$1"))}},r=function(e){n=[];var t;if(t=$.trim(e)){var o=t.split(";");$.each(o,function(e,t){var o=t.split(":");if(o.length>1){var r=$.trim(o[0]),a=$.trim(o[1]);r&&a&&n.push({column:r,columnDisplay:r.replace(/\s+/g,"").toLowerCase(),regex:i(a,"i")})}else{var l=$.trim(o[0]);l&&n.push({column:"",regex:i(l,"i")})}})}},a=ko.computed(function(){var e=o.filterText();o.extFilter||e==t||(t=e,r(e),o.evalFilter())});"number"==typeof o.throttle&&a.extend({throttle:o.throttle}),o.extFilter||e.columns.subscribe(function(e){$.each(e,function(e,t){o.fieldMap[t.displayName().toLowerCase().replace(/\s+/g,"")]=t.field})})},e.kg.SelectionService=function(e){var o=this;o.multi=e.config.multiSelect,o.selectedItems=e.config.selectedItems,o.selectedIndex=e.config.selectedIndex,o.lastClickedRow=void 0,o.ignoreSelectedItemChanges=!1,o.rowFactory={},o.Initialize=function(e){o.rowFactory=e},o.ChangeSelection=function(n,i){if(e.$$selectionPhase=!0,i&&i.shiftKey&&o.multi){if(o.lastClickedRow){var r=e.filteredData.indexOf(n.entity),a=e.filteredData.indexOf(o.lastClickedRow.entity);if(r==a)return!1;a++,a>r&&(r^=a,a=r^a,r^=a);for(var l=[];r>=a;a++)l.push(o.rowFactory.rowCache[a]);return l[l.length-1].beforeSelectionChange(l,i)&&($.each(l,function(e,n){n.selected(!0),n.entity[t]=!0,-1===o.selectedItems.indexOf(n.entity)&&o.selectedItems.push(n.entity)}),l[l.length-1].afterSelectionChange(l,i)),o.lastClickedRow=l[l.length-1],!0}}else o.multi?o.setSelection(n,!n.selected()):(o.lastClickedRow&&o.lastClickedRow!=n&&o.setSelection(o.lastClickedRow,!1),o.setSelection(n,e.config.keepLastSelected?!0:!n.selected()));return o.lastClickedRow=n,e.$$selectionPhase=!1,!0},o.setSelection=function(e,n){if(e.selected(n),e.entity[t]=n,n)-1===o.selectedItems.indexOf(e.entity)&&o.selectedItems.push(e.entity);else{var i=o.selectedItems.indexOf(e.entity);o.selectedItems.splice(i,1)}},o.toggleSelectAll=function(n){var i=o.selectedItems().length;i>0&&o.selectedItems.splice(0,i),$.each(e.filteredData(),function(e,i){i[t]=n,n&&o.selectedItems.push(i)}),$.each(o.rowFactory.rowCache,function(e,t){t&&t.selected&&t.selected(n)})}},e.kg.sortService={colSortFnCache:{},dateRE:/^(\d\d?)[\/\.-](\d\d?)[\/\.-]((\d\d)?\d\d)$/,guessSortFn:function(t){var o,n,i,r,a;if(void 0===t||null===t||""===t)return null;switch(n=typeof t){case"number":o=e.kg.sortService.sortNumber;break;case"boolean":o=e.kg.sortService.sortBool;break;default:o=void 0}return o?o:"[object Date]"===Object.prototype.toString.call(t)?e.kg.sortService.sortDate:"string"!==n?e.kg.sortService.basicSort:t.match(/^-?[£$¤]?[\d,.]+%?$/)?e.kg.sortService.sortNumberStr:(i=t.match(e.kg.sortService.dateRE),i?(r=parseInt(i[1],10),a=parseInt(i[2],10),r>12?e.kg.sortService.sortDDMMStr:a>12?e.kg.sortService.sortMMDDStr:e.kg.sortService.sortMMDDStr):e.kg.sortService.sortAlpha)},basicSort:function(e,t){return e==t?0:t>e?-1:1},sortNumber:function(e,t){return e-t},sortNumberStr:function(e,t){var o,n,i=!1,r=!1;return o=parseFloat(e.replace(/[^0-9.-]/g,"")),isNaN(o)&&(i=!0),n=parseFloat(t.replace(/[^0-9.-]/g,"")),isNaN(n)&&(r=!0),i&&r?0:i?1:r?-1:o-n},sortAlpha:function(e,t){var o=e.toLowerCase(),n=t.toLowerCase();return o==n?0:n>o?-1:1},sortBool:function(e,t){return e&&t?0:e||t?e?1:-1:0},sortDate:function(e,t){var o=e.getTime(),n=t.getTime();return o==n?0:n>o?-1:1},sortDDMMStr:function(t,o){var n,i,r,a,l,s;return r=t.match(e.kg.sortService.dateRE),s=r[3],a=r[2],l=r[1],1==a.length&&(a="0"+a),1==l.length&&(l="0"+l),n=s+a+l,r=o.match(e.kg.sortService.dateRE),s=r[3],a=r[2],l=r[1],1==a.length&&(a="0"+a),1==l.length&&(l="0"+l),i=s+a+l,n==i?0:i>n?-1:1},sortMMDDStr:function(t,o){var n,i,r,a,l,s;return r=t.match(e.kg.sortService.dateRE),s=r[3],l=r[2],a=r[1],1==a.length&&(a="0"+a),1==l.length&&(l="0"+l),n=s+a+l,r=o.match(e.kg.sortService.dateRE),s=r[3],l=r[2],a=r[1],1==a.length&&(a="0"+a),1==l.length&&(l="0"+l),i=s+a+l,n==i?0:i>n?-1:1},sortData:function(t,o){var n=t();if(n&&o){var r,a,l=o.column,s=o.direction;if(e.kg.sortService.colSortFnCache[l.field])r=e.kg.sortService.colSortFnCache[l.field];else if(void 0!=l.sortingAlgorithm)r=l.sortingAlgorithm,e.kg.sortService.colSortFnCache[l.field]=l.sortingAlgorithm;else{if(a=n[0],!a)return;r=kg.sortService.guessSortFn(a[l.field]),r?e.kg.sortService.colSortFnCache[l.field]=r:r=e.kg.sortService.sortAlpha}n.sort(function(t,o){var n=e.kg.utils.evalProperty(t,l.field),a=e.kg.utils.evalProperty(o,l.field);return a||n?n?a?s===i?r(n,a):0-r(n,a):-1:1:0}),t(n)}},Sort:function(t,o){e.kg.sortService.isSorting||(e.kg.sortService.isSorting=!0,e.kg.sortService.sortData(o,t),e.kg.sortService.isSorting=!1)}},e.kg.StyleProvider=function(t){t.canvasStyle=ko.computed(function(){return{height:t.maxCanvasHt().toString()+"px"}}),t.headerScrollerStyle=ko.computed(function(){return{height:t.config.headerRowHeight+"px"}}),t.topPanelStyle=ko.computed(function(){return{width:t.rootDim.outerWidth()+"px",height:t.topPanelHeight()+"px"}}),t.headerStyle=ko.computed(function(){return{width:Math.max(0,t.rootDim.outerWidth()-e.kg.domUtilityService.ScrollW)+"px",height:t.config.headerRowHeight+"px"}}),t.viewportStyle=ko.computed(function(){return{width:t.rootDim.outerWidth()+"px",height:t.viewportDimHeight()+"px"}}),t.footerStyle=ko.computed(function(){return{width:t.rootDim.outerWidth()+"px",height:t.config.footerRowHeight+"px"}})}}(window);
//# sourceMappingURL=KoGrid.min.js.map